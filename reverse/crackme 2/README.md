# crackme 2

Открываем бинарник в дебагере. И видим, что к пользовательскому вводу применяется RC4 с ключом в массиве unk_A94
```
RC4_set_key(v6, 16LL, &unk_A94);

RC4(v6, 40LL, s, v8);
```
Вывод сравнивается с заранее заложенными значениями в стеке v7
```
  v7[0] = -87;
  v7[1] = 13;
  v7[2] = 85;
  v7[3] = 31;
  v7[4] = 7;
  v7[5] = -31;
  v7[6] = -6;
  v7[7] = -122;
  v7[8] = -60;
  v7[9] = -41;
  v7[10] = 28;
  v7[11] = -114;
  v7[12] = -74;
  v7[13] = 20;
  v7[14] = 113;
  v7[15] = 88;
  v7[16] = -17;
  v7[17] = 54;
  v7[18] = 105;
  v7[19] = 78;
  v7[20] = 58;
...
```
По свойству RC4 мы можем получить исходный текст просто применив ту же операцию с ключом и нашим v7 массивом.

```
key = bytearray([
    0xF5, 0x7B, 0xE7, 0x6C,
    0xD3, 0xD1, 0x4F, 0x31,
    0xE3, 0xA8, 0x50, 0x53,
    0x83, 0x64, 0xCC, 0x56
])
v7 = bytearray([
    169, 13, 85, 31, 7, 225, 250, 134,
    196, 215, 28, 142, 182, 20, 113, 88,
    239, 54, 105, 78, 58, 155, 61, 164,
    167, 36, 47, 230, 115, 114, 98, 230,
    170, 131, 23, 180, 28, 248, 140, 80
])
flag = rc4(key, v7)
print("Flag:", flag.decode('utf-8', errors='replace'))
```
---
# Flag: MSKCTF{the_f0urth_arc_b4ea147bec02803ex}

